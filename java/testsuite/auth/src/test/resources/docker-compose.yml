version: "2.1"
services:
    rpisec-test-app-db:
        container_name: rpisec-test-app-db
        image: tobi312/rpi-postgresql:9.6
        environment:
            - POSTGRES_USER=rpisec-app
            - POSTGRES_PASSWORD=rpisec-app
            - POSTGRES_DATABASE=rpisec-app
        mem_limit: 128m
        cpu_shares: 4
    rpisec-test-app:
        container_name: rpisec-test-app
        build:
            context: ./app
        volumes:
            - ./volumes/app:/home/rpisec/app:rw
            - ./volumes/conf:/home/rpisec/conf:ro
            - ./volumes/image:/home/rpisec/image:rw
        environment:
            - APP_JAVA_OPTS=-Xms128m -Xmx200m
            VERSION=${VERSION}
        mem_limit: 256m
        cpu_shares: 4
        depends_on:
            - rpisec-test-app-db
